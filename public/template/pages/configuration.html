<div>
	<hmenu></hmenu>

	<div class="main">
		<div class="box" v-if="addEditConfig">
			<div class="wrapper">
				<h2>Create/Edit Configuration</h2>

				<msg :type="\'error\'" :msg="\'The configuration is invalid.\'" v-if="err != 0"></msg>

				<form v-on:submit.prevent="performAddEditConfig()">
					<table>
						<tr>
							<td colspan="2"><h3>Basic Settings</h3></td>
						</tr>
						<tr>
							<td class="w20">Name:</td>
							<td><input type="text" name="name" class="full-width" v-model="name" /></td>
						</tr>
						<tr>
							<td>Password:</td>
							<td><input type="password" name="pwd" class="full-width" v-model="pwd" /></td>
						</tr>
						<tr>
							<td>Admin password:</td>
							<td><input type="password" name="admin_pwd" class="full-width" v-model="admin_pwd" /></td>
						</tr>
						<tr>
							<td>Pickup mode:</td>
							<td><input type="checkbox" name="pickup_mode" v-model="pickup_mode" /></td>
						</tr>
						<tr>
							<td>Race overtime:</td>
							<td><input type="number" name="race_overtime" v-model="race_overtime" /></td>
						</tr>
						<tr>
							<td>Max. slots:</td>
							<td><input type="number" name="max_slots" v-model="max_slots" /></td>
						</tr>
						<tr>
							<td>Description:</td>
							<td><textarea name="description" v-model="description"></textarea></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Advanced Settings</h3></td>
						</tr>
						<tr>
							<td>UDP port:</td>
							<td><input type="number" name="udp" v-model="udp" /></td>
						</tr>
						<tr>
							<td>TCP port:</td>
							<td><input type="number" name="tcp" v-model="tcp" /></td>
						</tr>
						<tr>
							<td>HTTP port:</td>
							<td><input type="number" name="http" v-model="http" /></td>
						</tr>
						<tr>
							<td>Packets Hz:</td>
							<td><input type="number" name="packets_hz" v-model="packets_hz" /></td>
						</tr>
						<tr>
							<td>Loop mode:</td>
							<td><input type="checkbox" name="loop_mode" v-model="loop_mode" /></td>
						</tr>
						<tr>
							<td>Show on lobby:</td>
							<td><input type="checkbox" name="show_in_lobby" v-model="show_in_lobby" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Assists</h3></td>
						</tr>
						<tr>
							<td>ABS:</td>
							<td>
								<select name="abs" v-model="abs">
									<option>Factory</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>TC:</td>
							<td>
								<select name="tc" v-model="tc">
									<option>Factory</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>Stability aid:</td>
							<td><input type="checkbox" name="stability_aid" v-model="stability_aid" /></td>
						</tr>
						<tr>
							<td>Auto clutch:</td>
							<td><input type="checkbox" name="auto_clutch" v-model="auto_clutch" /></td>
						</tr>
						<tr>
							<td>Tyre blankets:</td>
							<td><input type="checkbox" name="tyre_blankets" v-model="tyre_blankets" /></td>
						</tr>
						<tr>
							<td>Force virtual mirror:</td>
							<td><input type="checkbox" name="force_virtual_mirror" v-model="force_virtual_mirror" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Realism</h3></td>
						</tr>
						<tr>
							<td>Fuel rate:</td>
							<td><input type="number" name="fuel_rate" v-model="fuel_rate" /></td>
						</tr>
						<tr>
							<td>Damage rate:</td>
							<td><input type="number" name="damage_rate" v-model="damage_rate" /></td>
						</tr>
						<tr>
							<td>Tires wear rate:</td>
							<td><input type="number" name="tires_wear_rate" v-model="tires_wear_rate" /></td>
						</tr>
						<tr>
							<td>Allowed tires out:</td>
							<td>
								<select name="allowed_tires_out" v-model="allowed_tires_out">
									<option>2</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>Max ballast:</td>
							<td><input type="number" name="max_ballast" v-model="max_ballast" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Dynamic Track</h3></td>
						</tr>
						<tr>
							<td>Dynamic track:</td>
							<td><input type="checkbox" name="dynamic_track" v-model="dynamic_track" /></td>
						</tr>
						<tr>
							<td>Condition:</td>
							<td>
								<select name="condition" v-model="condition">
									<option>Optimum</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>Start value:</td>
							<td><input type="number" name="start_value" v-model="start_value" /></td>
						</tr>
						<tr>
							<td>Randomness:</td>
							<td><input type="number" name="randomness" v-model="randomness" /></td>
						</tr>
						<tr>
							<td>Transferred grip:</td>
							<td><input type="number" name="transferred_grip" v-model="transferred_grip" /></td>
						</tr>
						<tr>
							<td>Laps to improve grip:</td>
							<td><input type="number" name="laps_to_improve_grip" v-model="laps_to_improve_grip" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Voting</h3></td>
						</tr>
						<tr>
							<td>Kick vote quorum:</td>
							<td><input type="number" name="kick_vote_quorum" v-model="kick_vote_quorum" /></td>
						</tr>
						<tr>
							<td>Session vote quorum:</td>
							<td><input type="number" name="session_vote_quorum" v-model="session_vote_quorum" /></td>
						</tr>
						<tr>
							<td>Vote duration:</td>
							<td><input type="number" name="vote_duration" v-model="vote_duration" /></td>
						</tr>
						<tr>
							<td>Blacklist:</td>
							<td>
								<select name="blacklist" v-model="blacklist">
									<option>Kick player</option>
								</select>
							</td>
						</tr>
						<tr>
							<td colspan="2"><h3>Booking</h3></td>
						</tr>
						<tr>
							<td>Booking:</td>
							<td><input type="checkbox" name="booking" v-model="booking" /></td>
						</tr>
						<tr>
							<td>Booking time:</td>
							<td><input type="number" name="booking_time" v-model="booking_time" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Practice</h3></td>
						</tr>
						<tr>
							<td>Practice:</td>
							<td><input type="checkbox" name="practice" v-model="practice" /></td>
						</tr>
						<tr>
							<td>Practice time:</td>
							<td><input type="number" name="practice_time" v-model="practice_time" /></td>
						</tr>
						<tr>
							<td>Can join:</td>
							<td><input type="checkbox" name="can_join_practice" v-model="can_join_practice" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Qualify</h3></td>
						</tr>
						<tr>
							<td>Qualify:</td>
							<td><input type="checkbox" name="qualify" v-model="qualify" /></td>
						</tr>
						<tr>
							<td>Qualify time:</td>
							<td><input type="number" name="qualify_time" v-model="qualify_time" /></td>
						</tr>
						<tr>
							<td>Can join:</td>
							<td><input type="checkbox" name="can_join_qualify" v-model="can_join_qualify" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Race</h3></td>
						</tr>
						<tr>
							<td>Race:</td>
							<td><input type="checkbox" name="race" v-model="race" /></td>
						</tr>
						<tr>
							<td>Race time:</td>
							<td><input type="number" name="race_time" v-model="race_time" /></td>
						</tr>
						<tr>
							<td>Race wait time:</td>
							<td><input type="number" name="race_wait_time" v-model="race_wait_time" /></td>
						</tr>
						<tr>
							<td>Join type:</td>
							<td>
								<select name="join_type" v-model="join_type">
									<option>Open</option>
								</select>
							</td>
						</tr>
						<tr>
							<td colspan="2"><h3>Time</h3></td>
						</tr>
						<tr>
							<td>Time:</td>
							<td><input type="time" name="time" v-model="time" /></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Weather</h3></td>
						</tr>
						<tr v-for="(w, i) in weather">
							<td colspan="2">
								<table>
									<tr>
										<td>Weather:</td>
										<td>
											<select name="weather" v-model="w.weather">
												<option>Clear</option>
											</select>
										</td>
										<td>
											<button v-on:click.prevent="removeWeather(i)">Remove Weather Panel</button>
										</td>
									</tr>
									<tr>
										<td>Base ambient temp:</td>
										<td><input type="number" name="base_ambient_temp" v-model="w.base_ambient_temp" /></td>
										<td></td>
									</tr>
									<tr>
										<td>Realistic road temp:</td>
										<td><input type="number" name="realistic_road_temp" v-model="w.realistic_road_temp" /></td>
										<td></td>
									</tr>
									<tr>
										<td>Base road temp:</td>
										<td><input type="number" name="base_road_temp" v-model="w.base_road_temp" /></td>
										<td></td>
									</tr>
									<tr>
										<td>Ambient variation:</td>
										<td><input type="number" name="ambient_variation" v-model="w.ambient_variation" /></td>
										<td></td>
									</tr>
									<tr>
										<td>Road variation:</td>
										<td><input type="number" name="road_variation" v-model="w.road_variation" /></td>
										<td></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="2"><button v-on:click.prevent="addWeather()">Add Weather Panel</button></td>
						</tr>
						<tr>
							<td colspan="2"><h3>Track</h3></td>
						</tr>
						<tr>
							<td colspan="2">
								<div class="select">
									<div class="option" v-for="(track, i) in tracks" v-on:click="selectTrack(i)" v-bind:class="{selected: selectedTrack == i}">
										<strong>{{track.name}}</strong>
										({{track.max_slots}})
										{{track.description}}
									</div>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan="2"><h3>Cars/Entry List</h3></td>
						</tr>
						<tr>
							<td colspan="2">
								<table>
									<tr>
										<td class="w33">
											<strong>Car</strong>

											<div class="select">
												<div class="option" v-for="(car, i) in cars" v-on:click="selectCar(i)" v-bind:class="{selected: selectedCar == i}">
													<strong>{{car.name}}</strong>
													{{car.description}}
												</div>
											</div>
										</td>
										<td class="w33">
											<strong>Painting</strong>

											<div class="select">
												<div class="option" v-for="(painting, i) in activePaintings" v-on:click="selectPainting(i)" v-bind:class="{selected: selectedPainting == i}">
													<strong>{{painting}}</strong>
												</div>
											</div>
										</td>
										<td class="w33">
											<button v-on:click.prevent="addCar()">Add Car</button>
										</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="2">
								<table>
									<thead>
										<tr>
											<td class="w20">Car</td>
											<td class="w20">Painting</td>
											<td></td>
										</tr>
									</thead>
									<tbody>
										<tr v-for="(car, i) in selectedCars">
											<td>{{car.name}}</td>
											<td>{{car.painting}}</td>
											<td>
												<i class="fa fa-angle-up" aria-hidden="true" title="Move up" v-on:click.prevent="carUp(i)"></i>
												<i class="fa fa-angle-down" aria-hidden="true" title="Move down" v-on:click.prevent="carDown(i)"></i>
												<i class="fa fa-trash" aria-hidden="true" title="Remove car" v-on:click.prevent="removeCar(i)"></i>
											</td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</table>

					<input type="submit" value="Save" />
					<button v-on:click.prevent="addEditConfig = false">Cancel</button>
				</form>
			</div>
		</div>

		<div class="box" v-if="removeConfig">
			<div class="wrapper">
				<h2>Remove Configuration</h2>

				<p>Do you really want to remove this configuration? This won\'t stop any instances currently running.</p>

				<button v-on:click="performRemoveConfig()">Yes, remove configuration</button>
				<button v-on:click="removeConfig = false">Cancel</button>
			</div>
		</div>

		<div class="box">
			<div class="wrapper">
				<h1>Configurations</h1>

				<msg :type="\'success\'" :msg="\'The configuration has been saved.\'" v-if="saved"></msg>
				<msg :type="\'success\'" :msg="\'The configuration has been removed.\'" v-if="removed"></msg>

				<button v-on:click="openAddEditConfig(0)">Add Configuration</button>

				<table>
					<thead>
						<tr>
							<td class="w5">ID</td>
							<td class="w40">Name</td>
							<td class="w40">Info</td>
							<td></td>
						</tr>
					</thead>
					<tbody>
						<tr v-for="config in configs">
							<td>{{config.id}}</td>
							<td>{{config.name}}</td>
							<td>{{config.track}}</td>
							<td>
								<i class="fa fa-pencil" aria-hidden="true" title="Edit configuration" v-on:click="openAddEditConfig(config.id)"></i>
								<i class="fa fa-files-o" aria-hidden="true" title="Copy configuration" v-on:click="copyConfig(config.id)"></i>
								<i class="fa fa-trash" aria-hidden="true" title="Remove configuration" v-on:click="openRemoveConfig(config.id)"></i>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
